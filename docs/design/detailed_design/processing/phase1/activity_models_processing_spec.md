# activity_models.py å‡¦ç†èª¬æ˜æ›¸

**æ–‡æ›¸ç•ªå·**: 12-002-PROC-002  
**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå**: æ˜†è™«è‡ªå‹•è¦³å¯Ÿï¼†ãƒ­ã‚°è¨˜éŒ²ã‚¢ãƒ—ãƒª  
**æ–‡æ›¸å**: activity_models.py å‡¦ç†èª¬æ˜æ›¸  
**å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**: `models/activity_models.py`  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0  
**ä½œæˆæ—¥**: 2025-07-28  
**ä½œæˆè€…**: é–‹ç™ºãƒãƒ¼ãƒ   

---

## ğŸ“‹ ãƒ•ã‚¡ã‚¤ãƒ«æ¦‚è¦

### ç›®çš„
æ˜†è™«ã®æ´»å‹•é‡ç®—å‡ºãƒ»åˆ†æã«é–¢é€£ã™ã‚‹ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’å®šç¾©ã—ã€æ´»å‹•é‡æŒ‡æ¨™ã‚„æ—¥æ¬¡ãƒ»æ™‚é–“åˆ¥çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã®ç®¡ç†ã‚’æä¾›ã™ã‚‹ã€‚

### ä¸»è¦æ©Ÿèƒ½
- æ´»å‹•é‡æŒ‡æ¨™ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹å®šç¾©
- æ—¥æ¬¡æ´»å‹•çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹å®šç¾©
- æ™‚é–“åˆ¥æ´»å‹•çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹å®šç¾©
- ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ãƒ»å¤‰æ›ãƒ»çµ±è¨ˆè¨ˆç®—æ©Ÿèƒ½

---

## ğŸ”§ é–¢æ•°ãƒ»ãƒ¡ã‚½ãƒƒãƒ‰ä»•æ§˜

### ActivityMetrics.__post_init__()

**æ¦‚è¦**: ActivityMetricsãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹ã®åˆæœŸåŒ–å¾Œæ¤œè¨¼å‡¦ç†

**å‡¦ç†å†…å®¹**:
1. total_detectionsãŒéè² æ•°ã§ã‚ã‚‹ã“ã¨ã‚’ãƒã‚§ãƒƒã‚¯
2. total_distanceãŒéè² æ•°ã§ã‚ã‚‹ã“ã¨ã‚’ãƒã‚§ãƒƒã‚¯
3. activity_durationãŒéè² æ•°ã§ã‚ã‚‹ã“ã¨ã‚’ãƒã‚§ãƒƒã‚¯

**å…¥åŠ›ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹**:
```python
def __post_init__(self) -> None:
```

**å‡ºåŠ›ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹**:
| æˆ»ã‚Šå€¤ | å‹ | èª¬æ˜ |
|-------|---|------|
| ãªã— | None | æ¤œè¨¼å®Œäº†å¾Œã«å‡¦ç†çµ‚äº† |

**ä¾‹å¤–**:
| ä¾‹å¤–å | ç™ºç”Ÿæ¡ä»¶ |
|-------|---------|
| ValueError | total_detections, total_distance, activity_durationãŒè² æ•°ã®å ´åˆ |

### ActivityMetrics.to_dict()

**æ¦‚è¦**: ActivityMetricsã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¾æ›¸å½¢å¼ã«å¤‰æ›

**å‡¦ç†å†…å®¹**:
1. å…¨å±æ€§ã‚’è¾æ›¸ã®ã‚­ãƒ¼ãƒ»å€¤ãƒšã‚¢ã«å¤‰æ›
2. è¾æ›¸ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”å´

**å…¥åŠ›ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹**:
```python
def to_dict(self) -> Dict[str, Any]:
```

**å‡ºåŠ›ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹**:
| æˆ»ã‚Šå€¤ | å‹ | èª¬æ˜ |
|-------|---|------|
| metrics_dict | Dict[str, Any] | æ´»å‹•é‡æŒ‡æ¨™ã®è¾æ›¸è¡¨ç¾ |

**ä½¿ç”¨ä¾‹**:
```python
metrics = ActivityMetrics(50, 1250.5, 25.5, "14:00-15:00", 180.0)
metrics_dict = metrics.to_dict()
```

### ActivityMetrics.calculate_activity_rate()

**æ¦‚è¦**: æ™‚é–“å½“ãŸã‚Šã®æ´»å‹•ç‡ã‚’è¨ˆç®—

**å‡¦ç†å†…å®¹**:
1. ç·æ¤œå‡ºå›æ•°ã‚’æ´»å‹•ç¶™ç¶šæ™‚é–“ï¼ˆæ™‚é–“å˜ä½ï¼‰ã§å‰²ã‚‹
2. 1æ™‚é–“å½“ãŸã‚Šã®å¹³å‡æ¤œå‡ºå›æ•°ã‚’ç®—å‡º

**å…¥åŠ›ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹**:
```python
def calculate_activity_rate(self) -> float:
```

**å‡ºåŠ›ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹**:
| æˆ»ã‚Šå€¤ | å‹ | èª¬æ˜ |
|-------|---|------|
| activity_rate | float | æ™‚é–“å½“ãŸã‚Šã®æ´»å‹•ç‡ï¼ˆæ¤œå‡ºå›æ•°/æ™‚é–“ï¼‰ |

**ä¾‹å¤–**:
| ä¾‹å¤–å | ç™ºç”Ÿæ¡ä»¶ |
|-------|---------|
| ZeroDivisionError | activity_durationãŒ0ã®å ´åˆ |

**ä½¿ç”¨ä¾‹**:
```python
metrics = ActivityMetrics(50, 1250.5, 25.5, "14:00-15:00", 180.0)
rate = metrics.calculate_activity_rate()
```

### DailyActivitySummary.add_hourly_data()

**æ¦‚è¦**: æ™‚é–“åˆ¥ãƒ‡ãƒ¼ã‚¿ã‚’æ—¥æ¬¡ã‚µãƒãƒªãƒ¼ã«è¿½åŠ 

**å‡¦ç†å†…å®¹**:
1. HourlyActivitySummaryã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å—ã‘å–ã‚‹
2. hourly_summariesãƒªã‚¹ãƒˆã«è¿½åŠ 
3. çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã®å†è¨ˆç®—ã‚’å®Ÿè¡Œ

**å…¥åŠ›ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹**:
```python
def add_hourly_data(self, hourly_data: HourlyActivitySummary) -> None:
```

| å¼•æ•°å | å‹ | å¿…é ˆ | èª¬æ˜ |
|-------|---|------|------|
| hourly_data | HourlyActivitySummary | â—‹ | è¿½åŠ ã™ã‚‹æ™‚é–“åˆ¥ãƒ‡ãƒ¼ã‚¿ |

**å‡ºåŠ›ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹**:
| æˆ»ã‚Šå€¤ | å‹ | èª¬æ˜ |
|-------|---|------|
| ãªã— | None | ãƒ‡ãƒ¼ã‚¿è¿½åŠ å®Œäº†å¾Œã«å‡¦ç†çµ‚äº† |

**ä½¿ç”¨ä¾‹**:
```python
daily_summary = DailyActivitySummary(...)
hourly_data = HourlyActivitySummary(...)
daily_summary.add_hourly_data(hourly_data)
```

### DailyActivitySummary.calculate_peak_hours()

**æ¦‚è¦**: ãƒ”ãƒ¼ã‚¯æ´»å‹•æ™‚é–“å¸¯ã‚’è¨ˆç®—

**å‡¦ç†å†…å®¹**:
1. å„æ™‚é–“åˆ¥ãƒ‡ãƒ¼ã‚¿ã®æ¤œå‡ºå›æ•°ã‚’æ¯”è¼ƒ
2. æœ€ã‚‚æ´»å‹•é‡ã®å¤šã„æ™‚é–“å¸¯ã‚’ç‰¹å®š
3. ãƒ”ãƒ¼ã‚¯æ™‚é–“å¸¯ã®ãƒªã‚¹ãƒˆã‚’ç”Ÿæˆ

**å…¥åŠ›ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹**:
```python
def calculate_peak_hours(self) -> List[str]:
```

**å‡ºåŠ›ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹**:
| æˆ»ã‚Šå€¤ | å‹ | èª¬æ˜ |
|-------|---|------|
| peak_hours | List[str] | ãƒ”ãƒ¼ã‚¯æ´»å‹•æ™‚é–“å¸¯ã®ãƒªã‚¹ãƒˆ |

**ä½¿ç”¨ä¾‹**:
```python
daily_summary = DailyActivitySummary(...)
peak_hours = daily_summary.calculate_peak_hours()
```

### DailyActivitySummary.generate_summary_stats()

**æ¦‚è¦**: æ—¥æ¬¡çµ±è¨ˆã‚µãƒãƒªãƒ¼ã‚’ç”Ÿæˆ

**å‡¦ç†å†…å®¹**:
1. æ™‚é–“åˆ¥ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å¹³å‡ãƒ»æœ€å¤§ãƒ»æœ€å°å€¤ã‚’ç®—å‡º
2. æ¨™æº–åå·®ã‚’è¨ˆç®—
3. çµ±è¨ˆã‚µãƒãƒªãƒ¼è¾æ›¸ã‚’ç”Ÿæˆ

**å…¥åŠ›ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹**:
```python
def generate_summary_stats(self) -> Dict[str, float]:
```

**å‡ºåŠ›ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹**:
| æˆ»ã‚Šå€¤ | å‹ | èª¬æ˜ |
|-------|---|------|
| stats | Dict[str, float] | çµ±è¨ˆã‚µãƒãƒªãƒ¼è¾æ›¸ |

**ä½¿ç”¨ä¾‹**:
```python
daily_summary = DailyActivitySummary(...)
stats = daily_summary.generate_summary_stats()
```

### HourlyActivitySummary.calculate_detection_density()

**æ¦‚è¦**: æ™‚é–“å½“ãŸã‚Šã®æ¤œå‡ºå¯†åº¦ã‚’è¨ˆç®—

**å‡¦ç†å†…å®¹**:
1. æ¤œå‡ºå›æ•°ã‚’æ™‚é–“ï¼ˆ60åˆ†ï¼‰ã§å‰²ã‚‹
2. åˆ†å½“ãŸã‚Šã®æ¤œå‡ºå¯†åº¦ã‚’ç®—å‡º

**å…¥åŠ›ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹**:
```python
def calculate_detection_density(self) -> float:
```

**å‡ºåŠ›ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹**:
| æˆ»ã‚Šå€¤ | å‹ | èª¬æ˜ |
|-------|---|------|
| density | float | åˆ†å½“ãŸã‚Šã®æ¤œå‡ºå¯†åº¦ |

**ä½¿ç”¨ä¾‹**:
```python
hourly_summary = HourlyActivitySummary(...)
density = hourly_summary.calculate_detection_density()
```

---

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿æ§‹é€ 

### ActivityMetrics

**æ¦‚è¦**: æ´»å‹•é‡æŒ‡æ¨™ã‚’è¡¨ç¾ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹

**å±æ€§**:
| å±æ€§å | å‹ | èª¬æ˜ |
|-------|---|------|
| total_detections | int | ç·æ¤œå‡ºå›æ•° |
| total_distance | float | ç·ç§»å‹•è·é›¢ï¼ˆãƒ”ã‚¯ã‚»ãƒ«ï¼‰ |
| avg_activity_per_hour | float | æ™‚é–“åˆ¥å¹³å‡æ´»å‹•é‡ |
| peak_activity_time | str | ãƒ”ãƒ¼ã‚¯æ´»å‹•æ™‚é–“å¸¯ |
| activity_duration | float | æ´»å‹•ç¶™ç¶šæ™‚é–“ï¼ˆåˆ†ï¼‰ |
| movement_patterns | List[str] | ç§»å‹•ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒªã‚¹ãƒˆ |

### DailyActivitySummary

**æ¦‚è¦**: æ—¥æ¬¡æ´»å‹•çµ±è¨ˆã‚’è¡¨ç¾ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹

**å±æ€§**:
| å±æ€§å | å‹ | èª¬æ˜ |
|-------|---|------|
| target_date | date | å¯¾è±¡æ—¥ä»˜ |
| total_detections | int | æ—¥æ¬¡ç·æ¤œå‡ºå›æ•° |
| total_distance | float | æ—¥æ¬¡ç·ç§»å‹•è·é›¢ |
| active_hours_count | int | æ´»å‹•æ™‚é–“æ•° |
| peak_activity_hours | List[str] | ãƒ”ãƒ¼ã‚¯æ´»å‹•æ™‚é–“å¸¯ãƒªã‚¹ãƒˆ |
| hourly_summaries | List[HourlyActivitySummary] | æ™‚é–“åˆ¥ã‚µãƒãƒªãƒ¼ãƒªã‚¹ãƒˆ |

### HourlyActivitySummary

**æ¦‚è¦**: æ™‚é–“åˆ¥æ´»å‹•çµ±è¨ˆã‚’è¡¨ç¾ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹

**å±æ€§**:
| å±æ€§å | å‹ | èª¬æ˜ |
|-------|---|------|
| hour | int | å¯¾è±¡æ™‚é–“ï¼ˆ0-23ï¼‰ |
| detections_count | int | æ™‚é–“å†…æ¤œå‡ºå›æ•° |
| distance_moved | float | æ™‚é–“å†…ç§»å‹•è·é›¢ |
| avg_confidence | float | å¹³å‡ä¿¡é ¼åº¦ |
| detection_intervals | List[float] | æ¤œå‡ºé–“éš”ãƒªã‚¹ãƒˆï¼ˆåˆ†ï¼‰ |

---

## ğŸ”„ å‡¦ç†ãƒ•ãƒ­ãƒ¼

### ãƒ¡ã‚¤ãƒ³å‡¦ç†ãƒ•ãƒ­ãƒ¼
```
1. ActivityMetricsã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç”Ÿæˆ
   â†“
2. __post_init__ã«ã‚ˆã‚‹è‡ªå‹•æ¤œè¨¼
   â†“
3. to_dict()ã«ã‚ˆã‚‹è¾æ›¸å¤‰æ›
   â†“
4. calculate_activity_rate()ã«ã‚ˆã‚‹æ´»å‹•ç‡ç®—å‡º
```

### æ—¥æ¬¡ã‚µãƒãƒªãƒ¼å‡¦ç†ãƒ•ãƒ­ãƒ¼
```
1. DailyActivitySummaryã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç”Ÿæˆ
   â†“
2. add_hourly_data()ã§æ™‚é–“åˆ¥ãƒ‡ãƒ¼ã‚¿è¿½åŠ 
   â†“
3. calculate_peak_hours()ã§ãƒ”ãƒ¼ã‚¯æ™‚é–“ç®—å‡º
   â†“
4. generate_summary_stats()ã§çµ±è¨ˆç”Ÿæˆ
```

### ã‚¨ãƒ©ãƒ¼å‡¦ç†ãƒ•ãƒ­ãƒ¼
```
ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ
   â†“
ValueErrorä¾‹å¤–ã‚’ã‚¹ãƒ­ãƒ¼
   â†“
å‘¼ã³å‡ºã—å…ƒã§ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
```

---

## ğŸ“ å®Ÿè£…ãƒ¡ãƒ¢

### æ³¨æ„äº‹é …
- field(default_factory=list)ã«ã‚ˆã‚Šãƒªã‚¹ãƒˆå±æ€§ã®åˆæœŸåŒ–ã‚’é©åˆ‡ã«è¡Œã†
- statisticsãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦çµ±è¨ˆè¨ˆç®—ã‚’å®Ÿè¡Œ
- æ™‚é–“è¨ˆç®—ã§ã¯åˆ†å˜ä½ã¨æ™‚é–“å˜ä½ã®å¤‰æ›ã«æ³¨æ„

### ä¾å­˜é–¢ä¿‚
- dataclassesï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰
- datetimeï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰
- typingï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰
- statisticsï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰

---

## ğŸ”„ æ›´æ–°å±¥æ­´

| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | æ›´æ–°æ—¥ | æ›´æ–°è€… | æ›´æ–°å†…å®¹ |
|-----------|--------|--------|----------|
| 1.0 | 2025-07-28 | é–‹ç™ºãƒãƒ¼ãƒ  | åˆç‰ˆä½œæˆ |