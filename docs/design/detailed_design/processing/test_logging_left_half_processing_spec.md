# test_logging_left_half.py å‡¦ç†èª¬æ˜æ›¸

**æ–‡æ›¸ç•ªå·**: 12-002-PROC-011
**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå**: æ˜†è™«è‡ªå‹•è¦³å¯Ÿï¼†ãƒ­ã‚°è¨˜éŒ²ã‚¢ãƒ—ãƒª
**æ–‡æ›¸å**: test_logging_left_half.py å‡¦ç†èª¬æ˜æ›¸
**å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**: `production/test_logging_left_half.py`
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0
**ä½œæˆæ—¥**: 2025-12-25
**ä½œæˆè€…**: é–‹ç™ºãƒãƒ¼ãƒ 

---

## ğŸ“‹ ãƒ•ã‚¡ã‚¤ãƒ«æ¦‚è¦

### ç›®çš„
Raspberry Pi Camera Module 3 Wideã‚’ä½¿ç”¨ã—ãŸé•·æ™‚é–“æ˜†è™«æ¤œå‡ºãƒ­ã‚®ãƒ³ã‚°ã‚¹ã‚¯ãƒªãƒ—ãƒˆã€‚ç”»é¢å·¦åŠåˆ†ã®ã¿ã‚’æ¤œå‡ºã‚¨ãƒªã‚¢ã¨ã—ã¦ä½¿ç”¨ã—ã€èª¤æ¤œå‡ºã‚’ä½æ¸›ã—ãªãŒã‚‰é•·æ™‚é–“ã®è‡ªå‹•è¦³æ¸¬ã‚’å®Ÿç¾ã™ã‚‹ã€‚

### ä¸»è¦æ©Ÿèƒ½
- ç”»é¢å·¦åŠåˆ†ï¼ˆ50%ï¼‰ã®ã¿ã‚’æ¤œå‡ºã‚¨ãƒªã‚¢ã¨ã—ã¦ä½¿ç”¨
- æŒ‡å®šé–“éš”ã§ã®è‡ªå‹•æ’®å½±ãƒ»æ¤œå‡º
- CSVå½¢å¼ã§ã®æ¤œå‡ºãƒ­ã‚°è¨˜éŒ²
- JSONå½¢å¼ã§ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ä¿å­˜
- æ¤œå‡ºæ™‚ã®ç”»åƒè‡ªå‹•ä¿å­˜ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
- ã‚ªãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚«ã‚¹/ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹å¯¾å¿œ
- ã‚«ãƒ¡ãƒ©ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®è©³ç´°è¨­å®š

### æœ¬ç•ªç’°å¢ƒã§ã®ä½¿ç”¨å®Ÿç¸¾

**é‡è¦**: æœ¬ãƒ•ã‚¡ã‚¤ãƒ«ã¯æœ¬ç•ªç’°å¢ƒã§å®Ÿéš›ã«ä½¿ç”¨ã•ã‚ŒãŸã‚ªãƒªã‚¸ãƒŠãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚**ç·¨é›†ç¦æ­¢**ã§ã™ã€‚

---

## ğŸ”§ æœ¬ç•ªç’°å¢ƒã§ä½¿ç”¨ã—ãŸã‚³ãƒãƒ³ãƒ‰

### 9æ™‚é–“ã®æœ¬ç•ªãƒ­ã‚®ãƒ³ã‚°ï¼ˆå®Ÿè¨¼æ¸ˆã¿æœ€é©ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼‰

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã¯å®Ÿéš›ã®æœ¬ç•ªç’°å¢ƒã§ä½¿ç”¨ã•ã‚Œã€é•·æ™‚é–“ãƒ‡ãƒ¼ã‚¿åé›†ã«æˆåŠŸã—ãŸã‚‚ã®ã§ã™ã€‚

```bash
cd production/

nohup python3 test_logging_left_half.py \
  --auto-focus \
  --conf 0.4 \
  --exposure -0.5 \
  --contrast 2 \
  --brightness -0.05 \
  --interval 60 \
  --duration 32400 \
  --save-images > logging_9h.log 2>&1 &
```

#### ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¬æ˜

| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | å€¤ | èª¬æ˜ |
|-----------|-----|------|
| `--auto-focus` | - | ã‚ªãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚’æœ‰åŠ¹åŒ– |
| `--conf` | 0.4 | æ¤œå‡ºä¿¡é ¼åº¦é–¾å€¤ï¼ˆ40%ä»¥ä¸Šã§æ¤œå‡ºã¨åˆ¤å®šï¼‰ |
| `--exposure` | -0.5 | éœ²å‡ºè£œæ­£ï¼ˆã‚„ã‚„æš—ã‚ã«è¨­å®šï¼‰ |
| `--contrast` | 2 | ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆå¼·èª¿ |
| `--brightness` | -0.05 | æ˜ã‚‹ã•å¾®èª¿æ•´ |
| `--interval` | 60 | è¦³æ¸¬é–“éš”ï¼ˆ60ç§’ï¼‰ |
| `--duration` | 32400 | ç·è¦³æ¸¬æ™‚é–“ï¼ˆ32400ç§’ = 9æ™‚é–“ï¼‰ |
| `--save-images` | - | æ¤œå‡ºæ™‚ã«ç”»åƒã‚’ä¿å­˜ |

### åé›†ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿

| ãƒ•ã‚¡ã‚¤ãƒ« | æœŸé–“ | ãƒ¬ã‚³ãƒ¼ãƒ‰æ•° |
|----------|------|-----------|
| `left_half_detection_log_20250902_220517.csv` | ç´„8æ™‚é–“ | 478ä»¶ |
| `left_half_detection_log_20250903_204658.csv` | ç´„9æ™‚é–“ | 538ä»¶ |
| `left_half_detection_log_20250904_210012.csv` | ç´„9æ™‚é–“ | 538ä»¶ |

---

## ğŸ’» ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°

### åŸºæœ¬æ§‹æ–‡
```bash
python3 test_logging_left_half.py [options]
```

### å¼•æ•°ä¸€è¦§

| å¼•æ•° | å‹ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|------|---|-----------|------|
| `--interval` | int | 60 | è¦³æ¸¬é–“éš”ï¼ˆç§’ï¼‰ |
| `--duration` | int | 3600 | ç·è¦³æ¸¬æ™‚é–“ï¼ˆç§’ï¼‰ |
| `--conf` | float | 0.3 | æ¤œå‡ºä¿¡é ¼åº¦é–¾å€¤ |
| `--save-images` | flag | False | æ¤œå‡ºæ™‚ã«ç”»åƒã‚’ä¿å­˜ |
| `--auto-focus` | flag | False | ã‚ªãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚«ã‚¹æœ‰åŠ¹åŒ– |
| `--focus-distance` | float | 30 | ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹è·é›¢ï¼ˆcmï¼‰ |
| `--exposure` | float | 0 | éœ²å‡ºè£œæ­£å€¤ |
| `--contrast` | float | 1.0 | ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆå€¤ |
| `--brightness` | float | 0 | æ˜ã‚‹ã•è£œæ­£å€¤ |
| `--output-dir` | str | insect_detection_logs | å‡ºåŠ›ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª |

---

## ğŸ“¤ å‡ºåŠ›ä»•æ§˜

### CSVãƒ•ã‚¡ã‚¤ãƒ«

**ãƒ•ã‚¡ã‚¤ãƒ«åãƒ‘ã‚¿ãƒ¼ãƒ³**: `left_half_detection_log_{YYYYMMDD_HHMMSS}.csv`

**ã‚«ãƒ©ãƒ å®šç¾©**:

| ã‚«ãƒ©ãƒ å | å‹ | èª¬æ˜ |
|----------|---|------|
| timestamp | str | ISO 8601å½¢å¼ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ— |
| observation_number | int | è¦³æ¸¬ç•ªå· |
| detection_count | int | æ¤œå‡ºæ•° |
| has_detection | bool | æ¤œå‡ºæœ‰ç„¡ |
| class_names | str | æ¤œå‡ºã‚¯ãƒ©ã‚¹å |
| confidence_values | str | ä¿¡é ¼åº¦å€¤ |
| bbox_coordinates | str | ãƒã‚¦ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒœãƒƒã‚¯ã‚¹åº§æ¨™ |
| center_x | float | æ¤œå‡ºä¸­å¿ƒXåº§æ¨™ |
| center_y | float | æ¤œå‡ºä¸­å¿ƒYåº§æ¨™ |
| bbox_width | float | ãƒã‚¦ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒœãƒƒã‚¯ã‚¹å¹… |
| bbox_height | float | ãƒã‚¦ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒœãƒƒã‚¯ã‚¹é«˜ã• |
| area | float | æ¤œå‡ºé¢ç© |
| detection_area | str | æ¤œå‡ºã‚¨ãƒªã‚¢ï¼ˆleft_halfï¼‰ |
| processing_time_ms | float | å‡¦ç†æ™‚é–“ï¼ˆãƒŸãƒªç§’ï¼‰ |
| image_saved | bool | ç”»åƒä¿å­˜æœ‰ç„¡ |
| image_filename | str | ä¿å­˜ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«å |

### ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿JSON

**ãƒ•ã‚¡ã‚¤ãƒ«åãƒ‘ã‚¿ãƒ¼ãƒ³**: `left_half_metadata_{YYYYMMDD_HHMMSS}.json`

**å†…å®¹**:
- ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚åˆ»
- æ¤œå‡ºã‚¨ãƒªã‚¢è¨­å®š
- ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±
- ã‚«ãƒ¡ãƒ©ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

---

## ğŸ“Š æœ¬ç•ªç’°å¢ƒã®å®Ÿè¡Œä¾‹

### ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆ1æ™‚é–“ï¼‰

```bash
python3 test_logging_left_half.py \
  --auto-focus \
  --conf 0.3 \
  --interval 30 \
  --duration 3600 \
  --save-images
```

### çŸ­æ™‚é–“ãƒ†ã‚¹ãƒˆï¼ˆ10åˆ†ï¼‰

```bash
python3 test_logging_left_half.py \
  --auto-focus \
  --interval 10 \
  --duration 600 \
  --save-images
```

### ãƒ—ãƒ­ã‚»ã‚¹ç®¡ç†

```bash
# å®Ÿè¡ŒçŠ¶æ³ç¢ºèª
ps aux | grep test_logging

# ãƒ­ã‚°ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–
tail -f logging_9h.log

# CSVãƒ‡ãƒ¼ã‚¿ç¢ºèª
tail -10 production/insect_detection_logs/*.csv
```

---

## ğŸ”— ä¾å­˜é–¢ä¿‚

### å¿…é ˆãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- picamera2
- libcamera
- opencv-python (cv2)
- numpy
- ultralytics (YOLO)

### ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢è¦ä»¶
- Raspberry Pi 4/5
- Camera Module 3 Wideï¼ˆæ¨å¥¨ï¼‰
- ååˆ†ãªã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å®¹é‡ï¼ˆé•·æ™‚é–“ãƒ­ã‚®ãƒ³ã‚°æ™‚ï¼‰

---

## âš ï¸ æ³¨æ„äº‹é …

### ãƒ•ã‚¡ã‚¤ãƒ«ä¿è­·ãƒãƒªã‚·ãƒ¼

**æœ¬ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`test_logging_left_half.py`ï¼‰ã¯æœ¬ç•ªç’°å¢ƒã§ä½¿ç”¨ã•ã‚ŒãŸã‚ªãƒªã‚¸ãƒŠãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚**

- **çµ¶å¯¾ã«ç·¨é›†ã—ãªã„ã§ãã ã•ã„**
- å¤‰æ›´ãŒå¿…è¦ãªå ´åˆã¯ `production_logging_left_half.py`ï¼ˆæ›¸ç±æ²è¼‰ç”¨ã‚³ãƒ”ãƒ¼ï¼‰ã‚’ç·¨é›†ã—ã¦ãã ã•ã„
- ãƒ­ã‚°ãƒ‡ãƒ¼ã‚¿ï¼ˆCSV/JSONï¼‰ã‚‚åŒæ§˜ã«ç·¨é›†ç¦æ­¢ã§ã™

---

## ğŸ“ æ›´æ–°å±¥æ­´

| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | æ—¥ä»˜ | æ›´æ–°å†…å®¹ |
|-----------|------|---------|
| 1.0 | 2025-12-25 | åˆç‰ˆä½œæˆ |

---

*æ–‡æ›¸ç•ªå·: 12-002-PROC-011*
*æœ€çµ‚æ›´æ–°æ—¥: 2025-12-25*
